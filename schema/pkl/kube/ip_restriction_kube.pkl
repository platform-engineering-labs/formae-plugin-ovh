/*
 * Â© 2025 Platform Engineering Labs Inc.
 *
 * SPDX-License-Identifier: FSL-1.1-ALv2
 */

/// OVH Managed Kubernetes IP Restriction
/// Manages API server access restrictions
/// API: PUT /cloud/project/{serviceName}/kube/{kubeId}/ipRestrictions
module ovh.kube.ip_restriction

import "@formae/formae.pkl"
import "../ovh.pkl"

const type = "OVH::Kube::IpRestriction"

/// Resolvable reference to an IP Restriction
open class IpRestrictionResolvable extends formae.Resolvable {
  hidden type = module.type

  hidden ip: IpRestrictionResolvable = (this) { property = "ip" }
}

@ovh.ResourceHint {
  type = module.type
  identifier = "ip"
}
open class IpRestriction extends formae.Resource {
  hidden parent = this

  /// Cloud project service name (project ID)
  @ovh.FieldHint { required = true; createOnly = true }
  serviceName: String

  /// Kubernetes cluster ID
  @ovh.FieldHint { required = true; createOnly = true }
  kubeId: (String|formae.Resolvable)

  /// IP block in CIDR notation (e.g., "192.168.1.0/24")
  @ovh.FieldHint { required = true; createOnly = true }
  ip: String

  /// Description of this IP restriction
  description: String?

  hidden res: IpRestrictionResolvable = new {
    label = parent.label
    stack = parent.stack?.label
  }
}
