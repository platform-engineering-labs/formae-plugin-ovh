/*
 * Â© 2025 Platform Engineering Labs Inc.
 *
 * SPDX-License-Identifier: FSL-1.1-ALv2
 */

amends "@formae/forma.pkl"

import "@ovh/compute/instance.pkl"

import "./vars.pkl" as v

forma {
  v.stack
  v.target

  // Simple instance test - only use the public network (Ext-Net)
  // This tests basic instance lifecycle without complex network dependencies
  new instance.Instance {
    label = "plugin-sdk-test-instance"
    name = "formae-plugin-sdk-test-\(v.testRunID)"
    flavorId = v.flavorID
    imageId = v.ubuntuImageID
    region = v.region
    networks = new Listing {
      // Public network (Ext-Net) - pre-existing OVH resource
      new instance.NetworkAttachment {
        networkId = v.extNetID
      }
    }
  }
}
